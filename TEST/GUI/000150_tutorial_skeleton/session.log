OOF.Microstructure.Create_From_ImageFile(filename='examples/small.ppm', microstructure_name='small.ppm', height=automatic, width=automatic)
OOF.Image.AutoGroup(image='small.ppm:small.ppm', name_template='%c')
OOF.Skeleton.New(name='skeleton', microstructure='small.ppm', x_elements=4, y_elements=4, skeleton_geometry=QuadSkeleton(left_right_periodicity=False,top_bottom_periodicity=False))
OOF.Windows.Graphics.New()
OOF.Graphics_1.Layer.Select(n=4)
OOF.Skeleton.Modify(skeleton='small.ppm:skeleton', modifier=Refine(targets=CheckHomogeneity(threshold=1),criterion=Unconditionally(),degree=Trisection(rule_set='conservative'),alpha=0.5))
OOF.Skeleton.Undo(skeleton='small.ppm:skeleton')
OOF.Skeleton.Redo(skeleton='small.ppm:skeleton')
OOF.Skeleton.Modify(skeleton='small.ppm:skeleton', modifier=Refine(targets=CheckHomogeneity(threshold=0.9),criterion=Unconditionally(),degree=Trisection(rule_set='conservative'),alpha=0.5))
OOF.Skeleton.Modify(skeleton='small.ppm:skeleton', modifier=SnapNodes(targets=SnapHeterogenous(threshold=0.9),criterion=AverageEnergy(alpha=1)))
OOF.Skeleton.Modify(skeleton='small.ppm:skeleton', modifier=Rationalize(targets=AllElements(),criterion=AverageEnergy(alpha=0.8),method=SpecificRationalization(rationalizers=[RemoveShortSide(ratio=5.0), QuadSplit(angle=150), RemoveBadTriangle(acute_angle=15,obtuse_angle=150)])))
OOF.ElementSelection.Select_by_Homogeneity(skeleton='small.ppm:skeleton', threshold=0.9)
OOF.Skeleton.Modify(skeleton='small.ppm:skeleton', modifier=SplitQuads(targets=SelectedElements(),criterion=AverageEnergy(alpha=0.9),split_how=GeographicQ2T()))
OOF.Skeleton.Modify(skeleton='small.ppm:skeleton', modifier=Rationalize(targets=AllElements(),criterion=AverageEnergy(alpha=0.8),method=SpecificRationalization(rationalizers=[RemoveShortSide(ratio=5.0), QuadSplit(angle=150), RemoveBadTriangle(acute_angle=15,obtuse_angle=150)])))
OOF.ElementSelection.Select_by_Homogeneity(skeleton='small.ppm:skeleton', threshold=0.9)
OOF.Skeleton.Modify(skeleton='small.ppm:skeleton', modifier=Anneal(targets=FiddleSelectedElements(),criterion=AverageEnergy(alpha=0.9),T=0.0,delta=1.0,iteration=ConditionalIteration(condition=AcceptanceRate(acceptance_rate=7),extra=3,maximum=100)))
OOF.Skeleton.Modify(skeleton='small.ppm:skeleton', modifier=Rationalize(targets=AllElements(),criterion=AverageEnergy(alpha=0.8),method=SpecificRationalization(rationalizers=[RemoveShortSide(ratio=5.0), QuadSplit(angle=150), RemoveBadTriangle(acute_angle=15,obtuse_angle=150)])))
OOF.ElementSelection.Select_by_Homogeneity(skeleton='small.ppm:skeleton', threshold=0.9)
OOF.Skeleton.Modify(skeleton='small.ppm:skeleton', modifier=Anneal(targets=FiddleSelectedElements(),criterion=AverageEnergy(alpha=0.9),T=0.0,delta=1.0,iteration=ConditionalIteration(condition=AcceptanceRate(acceptance_rate=7),extra=3,maximum=100)))
OOF.Skeleton.Modify(skeleton='small.ppm:skeleton', modifier=Rationalize(targets=AllElements(),criterion=AverageEnergy(alpha=0.8),method=SpecificRationalization(rationalizers=[RemoveShortSide(ratio=5.0), QuadSplit(angle=150), RemoveBadTriangle(acute_angle=15,obtuse_angle=150)])))
OOF.ElementSelection.Select_by_Homogeneity(skeleton='small.ppm:skeleton', threshold=0.9)
OOF.ElementSelection.Select_by_Homogeneity(skeleton='small.ppm:skeleton', threshold=0.8)
OOF.Skeleton.PinNodes.Pin_Internal_Boundary_Nodes(skeleton='small.ppm:skeleton')
OOF.Skeleton.Modify(skeleton='small.ppm:skeleton', modifier=SwapEdges(targets=AllElements(),criterion=AverageEnergy(alpha=0.5)))
OOF.Skeleton.Undo(skeleton='small.ppm:skeleton')
OOF.Skeleton.Redo(skeleton='small.ppm:skeleton')
OOF.Skeleton.Modify(skeleton='small.ppm:skeleton', modifier=Rationalize(targets=AllElements(),criterion=AverageEnergy(alpha=0.8),method=SpecificRationalization(rationalizers=[RemoveShortSide(ratio=5.0), QuadSplit(angle=150), RemoveBadTriangle(acute_angle=15,obtuse_angle=150)])))
OOF.Skeleton.Modify(skeleton='small.ppm:skeleton', modifier=MergeTriangles(targets=AllElements(),criterion=LimitedUnconditional(alpha=0.5,homogeneity=0.9,shape_energy=0.4)))
OOF.Skeleton.Undo(skeleton='small.ppm:skeleton')
OOF.Skeleton.Redo(skeleton='small.ppm:skeleton')
OOF.Skeleton.Modify(skeleton='small.ppm:skeleton', modifier=Smooth(targets=AllNodes(),criterion=LimitedUnconditional(alpha=0.5,homogeneity=0.9,shape_energy=0.4),T=0.0,iteration=FixedIteration(iterations=5)))
OOF.Skeleton.Undo(skeleton='small.ppm:skeleton')
OOF.Skeleton.Redo(skeleton='small.ppm:skeleton')
OOF.File.Save.Skeleton(filename='skeleton.dat', mode='w', format='ascii', skeleton='small.ppm:skeleton')
OOF.Skeleton.PinNodes.UnpinAll(skeleton='small.ppm:skeleton')
